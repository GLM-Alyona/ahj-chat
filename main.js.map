{"version":3,"file":"main.js","mappings":"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","sources":["webpack://ahj-chat/webpack/bootstrap","webpack://ahj-chat/webpack/runtime/publicPath","webpack://ahj-chat/./src/js/Chat.js","webpack://ahj-chat/./src/js/getCreationDate.js","webpack://ahj-chat/./src/js/Tooltip.js","webpack://ahj-chat/./src/js/RenderModal.js","webpack://ahj-chat/./src/img/cell.jpg","webpack://ahj-chat/./src/js/app.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","__webpack_require__.p = \"\";","/* eslint-disable linebreak-style */\n/* eslint-disable no-console */\nimport getCreationDate from './getCreationDate';\n\nexport default class Chat {\n  constructor(container, activeUser) {\n    this.container = container;\n    this.activeUser = activeUser;\n  }\n\n  renderConnectionUser(user) {\n    const connectionContainer = document.querySelector('.connection-container');\n\n    const connectionRow = document.createElement('UL');\n    const liPreview = document.createElement('LI');\n    const connectionPreview = document.createElement('DIV');\n    const liUser = document.createElement('LI');\n    const connectionUser = document.createElement('P');\n\n    connectionRow.classList.add('connection-row');\n    connectionPreview.classList.add('connection-prewiew');\n    connectionUser.classList.add('connection-user');\n\n    if (user === this.activeUser) {\n      connectionUser.classList.add('you');\n      connectionUser.textContent = `${user} (You)`;\n\n      window.onbeforeunload = async () => {\n        const query = `subscriptions/${encodeURIComponent(this.activeUser)}`;\n\n        fetch(`https://chat-backend-y9g8.onrender.com/${query}`, {\n          method: 'DELETE',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n        });\n      };\n    } else {\n      connectionUser.textContent = user;\n    }\n\n    connectionContainer.appendChild(connectionRow);\n    connectionRow.append(liPreview);\n    liPreview.append(connectionPreview);\n    connectionRow.append(liUser);\n    liUser.append(connectionUser);\n  }\n\n  static removeDisconnectionUser(user) {\n    const connectionUserArray = Array.from(document.querySelectorAll('.connection-user'));\n\n    const removeUser = connectionUserArray.find((item) => item.textContent === user);\n\n    removeUser.closest('.connection-row').remove();\n  }\n\n  async renderChat() {\n    const connectionContainer = document.createElement('DIV');\n\n    const chatContainer = document.createElement('DIV');\n    const chat = document.createElement('DIV');\n    const chatSend = document.createElement('FORM');\n    const chatMessage = document.createElement('INPUT');\n\n    chatContainer.classList.add('chat-container');\n    chat.classList.add('chat');\n    chatSend.classList.add('chat-send');\n    chatMessage.classList.add('chat-message');\n\n    chatMessage.placeholder = 'Type some text';\n\n    this.container.appendChild(chatContainer);\n    chatContainer.append(chat);\n    chatSend.append(chatMessage);\n    chatContainer.append(chatSend);\n\n    connectionContainer.classList.add('connection-container');\n    this.container.appendChild(connectionContainer);\n\n    this.messaging();\n\n    const request = fetch('https://chat-backend-y9g8.onrender.com', {\n      method: 'GET',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n    });\n    const result = await request;\n\n    if (!result.ok) {\n      console.error('Ошибка');\n\n      return;\n    }\n\n    const json = await result.json();\n\n    if (json) {\n      json.forEach((item) => {\n        this.renderConnectionUser(item.nickname);\n      });\n    }\n\n    this.gettingUsers();\n  }\n\n  renderMessage(autor, text) {\n    const chat = document.querySelector('.chat');\n    const boxMessage = document.createElement('DIV');\n    const information = document.createElement('SPAN');\n    const message = document.createElement('P');\n\n    boxMessage.classList.add('message-container');\n    information.classList.add('message-information');\n    message.classList.add('message-text');\n\n    const dateCreate = getCreationDate();\n\n    if (autor === this.activeUser) {\n      boxMessage.classList.add('right-align');\n      information.classList.add('you-message');\n      information.textContent = `${autor} (You), ${dateCreate}`;\n      message.textContent = text;\n    } else {\n      information.textContent = `${autor}, ${dateCreate}`;\n      message.textContent = text;\n    }\n\n    chat.appendChild(boxMessage);\n    boxMessage.append(information);\n    boxMessage.append(message);\n  }\n\n  gettingUsers() {\n    const eventSource = new EventSource('https://chat-backend-y9g8.onrender.com/sse');\n\n    eventSource.addEventListener('open', (e) => {\n      console.log(e);\n\n      console.log('sse open');\n    });\n\n    eventSource.addEventListener('error', (e) => {\n      console.log(e);\n\n      console.log('sse error');\n    });\n\n    eventSource.addEventListener('message', (e) => {\n      console.log(e);\n      console.log(e.data);\n      const { nickname, req } = JSON.parse(e.data);\n\n      if (req === 'add') {\n        this.renderConnectionUser(nickname);\n      }\n      if (req === 'remove') {\n        Chat.removeDisconnectionUser(nickname);\n      }\n\n      console.log('sse message');\n    });\n  }\n\n  messaging() {\n    const ws = new WebSocket('ws://chat-backend-y9g8.onrender.com/ws');\n\n    const chatMessage = document.querySelector('.chat-message');\n    const chatSend = document.querySelector('.chat-send');\n\n    chatSend.addEventListener('submit', (e) => {\n      e.preventDefault();\n\n      const message = {};\n\n      message.autor = this.activeUser;\n      message.text = chatMessage.value;\n\n      if (!message) return;\n\n      ws.send(JSON.stringify(message));\n\n      chatMessage.value = '';\n    });\n\n    ws.addEventListener('open', (e) => {\n      console.log(e);\n\n      console.log('ws open');\n    });\n\n    ws.addEventListener('close', (e) => {\n      console.log(e);\n\n      console.log('ws close');\n    });\n\n    ws.addEventListener('error', (e) => {\n      console.log(e);\n\n      console.log('ws error');\n    });\n\n    ws.addEventListener('message', (e) => {\n      const data = JSON.parse(e.data);\n      const { chat: messages } = data;\n\n      messages.forEach((message) => {\n        const { autor } = JSON.parse(message);\n        const { text } = JSON.parse(message);\n\n        this.renderMessage(autor, text);\n      });\n\n      console.log('ws message');\n    });\n  }\n}\n","/* eslint-disable linebreak-style */\nexport default function getCreationDate() {\n  const date = new Date();\n  let dateHours = date.getHours();\n  let dateMinutes = date.getMinutes();\n  let dateDay = date.getDate();\n  let dateMonth = date.getMonth() + 1;\n  if (dateHours < 10) {\n    dateHours = `0${dateHours}`;\n  }\n  if (dateMinutes < 10) {\n    dateMinutes = `0${dateMinutes}`;\n  }\n  if (dateDay < 10) {\n    dateDay = `0${dateDay}`;\n  }\n  if (dateMonth < 10) {\n    dateMonth = `0${dateMonth}`;\n  }\n  return `${dateHours}:${dateMinutes} ${dateDay}.${dateMonth}.${date.getFullYear()}`;\n}\n","/* eslint-disable linebreak-style */\nexport default class Tooltip {\n  constructor() {\n    this._tooltips = [];\n  }\n\n  showTooltip(message, element) {\n    const tooltipElement = document.createElement('DIV');\n\n    tooltipElement.classList.add('form-error');\n    tooltipElement.textContent = message;\n\n    const id = performance.now();\n\n    this._tooltips.push({\n      id,\n      element: tooltipElement,\n    });\n\n    document.body.appendChild(tooltipElement);\n\n    const { right, top } = element.getBoundingClientRect();\n\n    tooltipElement.style.left = `${right + 5}px`;\n    tooltipElement.style.top = `${top + element.offsetHeight / 2 - tooltipElement.offsetHeight / 2}px`;\n    return id;\n  }\n\n  removeTooltip(id) {\n    const tooltip = this._tooltips.find((t) => t.id === id);\n\n    if (tooltip) {\n      tooltip.element.remove();\n    }\n\n    this._tooltips = this._tooltips.filter((t) => t.id !== id);\n  }\n\n  removeAllTooltip() {\n    this._tooltips.forEach((item) => item.element.remove());\n    this._tooltips = [];\n  }\n}\n","/* eslint-disable linebreak-style */\n/* eslint-disable no-console */\nimport Chat from './Chat';\nimport Tooltip from './Tooltip';\n\nexport default class RenderModal {\n  constructor(container) {\n    this.container = container;\n    this.tooltipFactory = new Tooltip();\n  }\n\n  enterUser() {\n    const modalContainer = document.createElement('DIV');\n    const titleModal = document.createElement('H1');\n    const formModal = document.createElement('FORM');\n    const inputModal = document.createElement('INPUT');\n    const buttonModal = document.createElement('BUTTON');\n\n    modalContainer.classList.add('modal-container');\n    titleModal.classList.add('modal-title');\n    formModal.classList.add('modal-form');\n    inputModal.classList.add('modal-input');\n    buttonModal.classList.add('modal-button');\n\n    formModal.setAttribute('novalidate', true);\n    inputModal.setAttribute('required', true);\n    inputModal.name = 'nickname';\n    inputModal.setCustomValidity('');\n\n    titleModal.textContent = 'Выберите псевдоним';\n    buttonModal.textContent = 'Продолжить';\n\n    this.container.appendChild(modalContainer);\n    modalContainer.append(titleModal);\n    formModal.append(inputModal);\n    formModal.append(buttonModal);\n    modalContainer.append(formModal);\n\n    let actualMessages = [];\n\n    const showTooltip = (message, el) => {\n      actualMessages.push({\n        name: el.name,\n        id: this.tooltipFactory.showTooltip(message, el),\n      });\n    };\n\n    formModal.addEventListener('submit', async (e) => {\n      e.preventDefault();\n\n      actualMessages.forEach((message) => this.tooltipFactory.removeTooltip(message.id));\n      actualMessages = [];\n\n      let request; let result; let\n        json;\n\n      request = fetch('https://chat-backend-y9g8.onrender.com/index/', {\n        method: 'GET',\n        headers: {\n          'Content-Type': 'application/json',\n        },\n      });\n\n      RenderModal.generationLoading(modalContainer);\n\n      result = await request;\n\n      if (!result.ok) {\n        console.error('Ошибка');\n\n        return;\n      }\n\n      json = await result.json();\n\n      if (json) {\n        json.forEach((item) => {\n          if (item.nickname === inputModal.value) {\n            inputModal.setCustomValidity('customError');\n          } else {\n            inputModal.setCustomValidity('');\n          }\n        });\n      }\n\n      if (formModal.checkValidity()) {\n        const nickname = inputModal.value;\n\n        const chat = new Chat(this.container, nickname);\n\n        request = fetch('https://chat-backend-y9g8.onrender.com/subscriptions/', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({ nickname }),\n        });\n\n        result = await request;\n\n        if (!result.ok) {\n          console.error('Ошибка');\n\n          return;\n        }\n\n        json = await result.json();\n        const { status } = json;\n\n        if (status === 'OK') {\n          modalContainer.classList.add('display-none');\n          chat.renderChat();\n        }\n      } else {\n        const error = RenderModal.getError(inputModal);\n\n        if (error) {\n          showTooltip(error, inputModal);\n        }\n      }\n    });\n\n    const elementOnBlur = (e) => {\n      const el = e.target;\n\n      const error = RenderModal.getError(el);\n      if (error) {\n        showTooltip(error, el);\n      } else {\n        const currentErrorMessage = actualMessages.find((item) => item.name === el.name);\n\n        if (currentErrorMessage) {\n          this.tooltipFactory.removeTooltip(currentErrorMessage.id);\n        }\n      }\n\n      el.removeEventListener('blur', elementOnBlur);\n    };\n\n    inputModal.addEventListener('focus', () => {\n      inputModal.addEventListener('blur', elementOnBlur);\n    });\n  }\n\n  static getError(el) {\n    document.querySelector('.loadingio-spinner-spinner-ugc4sg2wum').remove();\n    const errors = {\n      nickname: {\n        valueMissing: 'Заполните, пожалуйста, поле \"Псевдоним\"',\n        customError: 'Пользователь с таким псевдонимом уже есть в чате, придумайте другой',\n      },\n    };\n\n    const errorKey = Object.keys(ValidityState.prototype).find((key) => {\n      if (!el.name) return null;\n      if (key === 'valid') return null;\n\n      if (el.validity[key]) console.log(key);\n\n      return el.validity[key];\n    });\n\n    if (!errorKey) return null;\n\n    return errors[el.name][errorKey];\n  }\n\n  static generationLoading(container) {\n    if (!document.querySelector('.loadingio-spinner-spinner-ugc4sg2wum')) {\n      const imageContainer = document.createElement('DIV');\n      const animation = document.createElement('DIV');\n\n      imageContainer.classList.add('loadingio-spinner-spinner-ugc4sg2wum');\n      animation.classList.add('ldio-7nr8cpu8w2k');\n\n      container.appendChild(imageContainer);\n      imageContainer.append(animation);\n      for (let i = 12; i !== 0; i -= 1) {\n        animation.append(document.createElement('DIV'));\n      }\n    }\n  }\n}\n","export default __webpack_public_path__ + \"assets/253f7b15dd6eb9ac37984ada287333f9.jpg\";","/* eslint-disable linebreak-style */\nimport RenderModal from './RenderModal';\n\nimport background from '../img/cell.jpg';\n\ndocument.querySelector('body').style.backgroundImage = `url(${background})`;\n\nconst container = document.querySelector('.app-container');\nconst render = new RenderModal(container);\n\nrender.enterUser();\n"],"names":["__webpack_require__","Chat","constructor","container","activeUser","this","renderConnectionUser","user","connectionContainer","document","querySelector","connectionRow","createElement","liPreview","connectionPreview","liUser","connectionUser","classList","add","textContent","window","onbeforeunload","async","query","encodeURIComponent","fetch","method","headers","appendChild","append","removeDisconnectionUser","Array","from","querySelectorAll","find","item","closest","remove","renderChat","chatContainer","chat","chatSend","chatMessage","placeholder","messaging","request","result","ok","console","error","json","forEach","nickname","gettingUsers","renderMessage","autor","text","boxMessage","information","message","dateCreate","date","Date","dateHours","getHours","dateMinutes","getMinutes","dateDay","getDate","dateMonth","getMonth","getFullYear","getCreationDate","eventSource","EventSource","addEventListener","e","log","data","req","JSON","parse","ws","WebSocket","preventDefault","value","send","stringify","messages","Tooltip","_tooltips","showTooltip","element","tooltipElement","id","performance","now","push","body","right","top","getBoundingClientRect","style","left","offsetHeight","removeTooltip","tooltip","t","filter","removeAllTooltip","RenderModal","tooltipFactory","enterUser","modalContainer","titleModal","formModal","inputModal","buttonModal","setAttribute","name","setCustomValidity","actualMessages","el","generationLoading","checkValidity","status","getError","elementOnBlur","target","currentErrorMessage","removeEventListener","errorKey","Object","keys","ValidityState","prototype","key","validity","valueMissing","customError","imageContainer","animation","i","backgroundImage","background"],"sourceRoot":""}